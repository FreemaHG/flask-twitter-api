# Описание проекта
Проект представляет собой backend-составляющую (API для twitter-подобного приложения) с возможностью постить твиты 
с картинками, ставить лайки, дизлайки, просматривать данные о себе и других пользователях, подписываться на других 
пользователей и просматривать ленту с твитами.

Предполагается, что у нас корпоративная сеть, а потому в сервисе нет возможности авторизации - 
аутентификация пользователей осуществляется через **токен в header**.

## Используемые инструменты
* **Python** (3.11);
* **Flask** (Wev Framework);
* **Flasgger** (Api documentation);
* **Docker** and **Docker Compose** (containerization);
* **PostgreSQL** (database);
* **Flask-SQLAlchemy** (working with database from Python);
* **Flask-Migrate** (database migrations made easy);
* **Marshmallow** (data verification);
* **Loguru** (logging);
* **Pytest** (tests);
* **Nginx** (server for linking frontend and backend).

## Сборка и запуск приложения
1. Скачиваем содержимое репозитория в отдельную папку:
    ```
    git clone https://github.com/FreemaHG/python_advanced_diploma.git
    ```
2. Переименовываем файл "**.env.template**" в "**.env**", при необходимости можно задать свои параметры.


3. Собираем и запускаем контейнеры с приложением. В терминале в общей директории (с файлом "docker-compose.yml") 
вводим команду:
    ```
    docker-compose up -d
    ```

Загрузка демонстрационных данных и запуск сервера происходят автоматически. 
В демонстрационных данных пользователи **test**, **test2** и **test3** уже подписаны друг на друга. 
Добавлены твиты с изображениями и лайки к записям.

## Документация

После сборки и запуска приложения ознакомиться с документацией API можно по адресу:
    ```
    <your_domain>/apidocs/
    ```

## Frontend

Для установки токена в header в правом верхнем углу frontend-ом предусмотрена форма для ввода api-key, 
по-умолчанию используется значение "test". После загрузки демонстрационны данных в БД будут сведения для 
пользователей с токенами "**test**", **test2**" и "**test3**". 
Все пользователи имеют данные с твитами, лайками и подписками.

## Запуск сервера разработки

1. После скачивания репозитория на локальную машину, создаем виртуальное окружение и устанавливаем зависимости 
    из корневой директории командой:
    ```
    pip install -r requirements/developments.txt
    ```
   
2. В файле с переменными окружения "**.env**" меняем значение на:
    ```
    APP_SETTINGS="app.config.DevelopmentConfig"
    DB_HOST=localhost
    ```
   
2. В корне проекта вводим команду для запуска DB (собираем и запускаем контейнер с PostgreSQL):
    ```
    docker-compose up postgres
    ```
   
3. Подгружаем демонстрационные данные (если нужно):
    ```
    python3 -m app.utils.data_migrations
    ```
   
4. Запускаем сервер для разработки:
    ```
    flusk run
    ```

## Тестирование

1. Скачиваем репозиторий на локальную машину, меняем переменные окружения, устанавливаем зависимости 
    в виртуальное окружение, запускаем контейнер с БД (см. предыдущий пункт):


2. Запускаем тесты:
    ```
    pytest -v
    ```